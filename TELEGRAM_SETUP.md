# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Telegram-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –∏ –±—ç–∫–∞–ø–æ–≤

## 1. –°–æ–∑–¥–∞–Ω–∏–µ Telegram-–±–æ—Ç–∞

1. –û—Ç–∫—Ä–æ–π—Ç–µ Telegram –∏ –Ω–∞–π–¥–∏—Ç–µ [@BotFather](https://t.me/BotFather)
2. –ù–∞–ø–∏—à–∏—Ç–µ `/newbot`
3. –í–≤–µ–¥–∏—Ç–µ –∏–º—è –±–æ—Ç–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–ê–ª–∏–º –ú–∏–¥–∞—Ç –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è")
4. –í–≤–µ–¥–∏—Ç–µ username (–Ω–∞–ø—Ä–∏–º–µ—Ä, `alim_midat_bot`)
5. **BotFather –¥–∞—Å—Ç –≤–∞–º TOKEN** ‚Äî —Å–æ—Ö—Ä–∞–Ω–∏—Ç–µ –µ–≥–æ

## 2. –ü–æ–ª—É—á–µ–Ω–∏–µ ID –∫–∞–Ω–∞–ª–∞/—á–∞—Ç–∞

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ß–µ—Ä–µ–∑ –∫–∞–Ω–∞–ª
1. –°–æ–∑–¥–∞–π—Ç–µ –ø—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–∞–Ω–∞–ª –≤ Telegram
2. –î–æ–±–∞–≤—å—Ç–µ –≤–∞—à–µ–≥–æ –±–æ—Ç–∞ –≤ –∫–∞–Ω–∞–ª –∫–∞–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
3. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –ª—é–±–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ –∫–∞–Ω–∞–ª
4. –û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ:
   ```
   https://api.telegram.org/bot<–í–ê–®_TOKEN>/getUpdates
   ```
5. –ù–∞–π–¥–∏—Ç–µ `"chat":{"id":-1001234567890}` ‚Äî —ç—Ç–æ ID –≤–∞—à–µ–≥–æ –∫–∞–Ω–∞–ª–∞

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ß–µ—Ä–µ–∑ –±–æ—Ç–∞
1. –ù–∞–ø–∏—à–∏—Ç–µ –≤–∞—à–µ–º—É –±–æ—Ç—É –ª—é–±–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
2. –û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ:
   ```
   https://api.telegram.org/bot<–í–ê–®_TOKEN>/getUpdates
   ```
3. –ù–∞–π–¥–∏—Ç–µ `"chat":{"id":123456789}` ‚Äî —ç—Ç–æ –≤–∞—à ID

## 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

### –û–±–Ω–æ–≤–∏—Ç–µ .env —Ñ–∞–π–ª

```bash
nano /opt/alim-kitabhane/.env
```

–î–æ–±–∞–≤—å—Ç–µ (–∏–ª–∏ –æ–±–Ω–æ–≤–∏—Ç–µ) —Å–ª–µ–¥—É—é—â–∏–µ —Å—Ç—Ä–æ–∫–∏:

```env
TELEGRAM_BOT_TOKEN=–≤–∞—à_—Ç–æ–∫–µ–Ω_–æ—Ç_BotFather
TELEGRAM_CHAT_ID=–≤–∞—à_chat_id
```

–°–æ—Ö—Ä–∞–Ω–∏—Ç–µ: Ctrl+O, Enter, Ctrl+X

### –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

```bash
cd /opt/alim-kitabhane
docker compose restart app
```

## 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞ —Å–∞–π—Ç–µ ‚Äî –¥–æ–ª–∂–Ω–æ –ø—Ä–∏–π—Ç–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ.

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –±—ç–∫–∞–ø–∞ –≤—Ä—É—á–Ω—É—é

```bash
docker compose exec app npm run backup
```

–ï—Å–ª–∏ –≤—Å—ë –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ, –≤—ã –ø–æ–ª—É—á–∏—Ç–µ —Ñ–∞–π–ª –±—ç–∫–∞–ø–∞ –≤ Telegram.

## 5. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –±—ç–∫–∞–ø (–∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 22:00 –ú–°–ö)

### –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ cron

```bash
crontab -e
```

–î–æ–±–∞–≤—å—Ç–µ —Å—Ç—Ä–æ–∫—É (–≤—ã–±–µ—Ä–∏—Ç–µ 1 - nano):

```cron
0 22 * * * cd /opt/alim-kitabhane && docker compose exec -T app npm run backup >> /var/log/backup.log 2>&1
```

–°–æ—Ö—Ä–∞–Ω–∏—Ç–µ: Ctrl+O, Enter, Ctrl+X

### –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ cron —Ä–∞–±–æ—Ç–∞–µ—Ç

```bash
crontab -l
```

### –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏ –±—ç–∫–∞–ø–∞

```bash
tail -f /var/log/backup.log
```

## 6. –ò–∑–º–µ–Ω–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –±—ç–∫–∞–ø–∞

–§–æ—Ä–º–∞—Ç cron: `–º–∏–Ω—É—Ç–∞ —á–∞—Å –¥–µ–Ω—å –º–µ—Å—è—Ü –¥–µ–Ω—å_–Ω–µ–¥–µ–ª–∏`

–ü—Ä–∏–º–µ—Ä—ã:

- **–ö–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 22:00 –ú–°–ö:** `0 22 * * *`
- **–ö–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 18:00 –ú–°–ö:** `0 18 * * *`
- **–ö–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 23:59 –ú–°–ö:** `59 23 * * *`
- **–î–≤–∞ —Ä–∞–∑–∞ –≤ –¥–µ–Ω—å (—É—Ç—Ä–æ –∏ –≤–µ—á–µ—Ä):** `0 9,22 * * *`

## 7. –¢–∏–ø—ã —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

### üÜï –ù–æ–≤–∞—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
- –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- Email
- –î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è

### üí∞ –ù–æ–≤–∞—è –ø–æ–∫—É–ø–∫–∞
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏ email
- –ù–∞–∑–≤–∞–Ω–∏–µ –∫–Ω–∏–≥–∏
- –°—É–º–º–∞ –ø–æ–∫—É–ø–∫–∏
- ID –ø–ª–∞—Ç–µ–∂–∞ –ÆKassa
- –î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è

### üì¶ –ë—ç–∫–∞–ø –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- –§–∞–π–ª .db –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –≤ Telegram
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–∞–∂–¥—ã–π –≤–µ—á–µ—Ä
- –°—Ç–∞—Ä—ã–µ –±—ç–∫–∞–ø—ã —É–¥–∞–ª—è—é—Ç—Å—è (—Ö—Ä–∞–Ω—è—Ç—Å—è 7 –¥–Ω–µ–π)

## 8. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

‚ö†Ô∏è **–í–∞–∂–Ω–æ:**
- –ù–∏–∫–æ–º—É –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–π—Ç–µ `TELEGRAM_BOT_TOKEN`
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–∞–Ω–∞–ª –¥–ª—è –±—ç–∫–∞–ø–æ–≤
- –•—Ä–∞–Ω–∏—Ç–µ –±—ç–∫–∞–ø—ã –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ–º –º–µ—Å—Ç–µ
- –†–µ–≥—É–ª—è—Ä–Ω–æ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ, —á—Ç–æ –±—ç–∫–∞–ø—ã —Å–æ–∑–¥–∞—é—Ç—Å—è

## 9. –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –Ω–µ –ø—Ä–∏—Ö–æ–¥—è—Ç

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å —Ç–æ–∫–µ–Ω–∞ –∏ chat_id –≤ `.env`
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –±–æ—Ç –¥–æ–±–∞–≤–ª–µ–Ω –≤ –∫–∞–Ω–∞–ª –∫–∞–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏:
   ```bash
   docker logs --tail=100 krym-chitalka-app
   ```

### –ë—ç–∫–∞–ø –Ω–µ —Å–æ–∑–¥–∞—ë—Ç—Å—è

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –Ω–∞ –ø–∞–ø–∫—É:
   ```bash
   mkdir -p /opt/alim-kitabhane/backups
   chmod 777 /opt/alim-kitabhane/backups
   ```

2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤—Ä—É—á–Ω—É—é:
   ```bash
   docker compose exec app npm run backup
   ```

3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ cron:
   ```bash
   tail -f /var/log/backup.log
   ```

## 10. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### –û—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤—Ä—É—á–Ω—É—é

–í—ã –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Telegram Bot API –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –ª—é–±—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π:

```bash
curl -X POST https://api.telegram.org/bot<TOKEN>/sendMessage \
  -H "Content-Type: application/json" \
  -d '{"chat_id":"<CHAT_ID>","text":"–¢–µ—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ"}'
```

