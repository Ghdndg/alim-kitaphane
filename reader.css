/* КрымЧиталка — качественный ридер */

:root{
  --bg-primary:#ffffff;
  --bg-secondary:#f7f7f9;
  --bg-tertiary:#eceef2;
  --text-primary:#1a1a1a;
  --text-secondary:#667085;
  --text-muted:#98a2b3;
  --accent:#4f46e5;
  --accent-hover:#4338ca;
  --border:#e5e7eb;
  --shadow:rgba(0,0,0,.08);
  --shadow-lg:rgba(0,0,0,.14);

  --font-ui:'Inter',system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
  --font-reading:'Crimson Text',Georgia,serif;
  --font-size-reading:18px;
  --line-height-reading:1.7;

  --transition:all .2s ease;
}

[data-theme="dark"]{
  --bg-primary:#141416;
  --bg-secondary:#1b1d20;
  --bg-tertiary:#26292e;
  --text-primary:#f6f7f9;
  --text-secondary:#c9ced6;
  --text-muted:#9aa3af;
  --border:#2e3238;
  --shadow:rgba(0,0,0,.4);
  --shadow-lg:rgba(0,0,0,.6);
}

[data-theme="sepia"]{
  --bg-primary:#f4f1ea;
  --bg-secondary:#efe9dd;
  --bg-tertiary:#e8e0cf;
  --text-primary:#4b3d2b;
  --text-secondary:#7b6a51;
  --text-muted:#9a8b73;
  --border:#d6ccb9;
  --shadow:rgba(92,75,55,.12);
  --shadow-lg:rgba(92,75,55,.18);
}

*{box-sizing:border-box;margin:0;padding:0}
html,body{height:100%}
body{
  font-family:var(--font-ui);
  color:var(--text-primary);
  background:var(--bg-primary);
  display:flex;flex-direction:column;
  -webkit-font-smoothing:antialiased;
  -moz-osx-font-smoothing:grayscale;
}

/* Loading */
.loading-screen{
  position:fixed;inset:0;display:flex;align-items:center;justify-content:center;
  background:var(--bg-primary);z-index:9999;transition:opacity .3s ease;
}
.loading-screen.hidden{opacity:0;pointer-events:none}
.loading-content{text-align:center}
.loading-spinner{width:48px;height:48px;border:4px solid var(--border);border-top:4px solid var(--accent);border-radius:50%;margin:0 auto 12px;animation:spin 1s linear infinite}
@keyframes spin{to{transform:rotate(360deg)}}

/* Header */
.reader-header{
  height:64px;display:flex;align-items:center;justify-content:space-between;
  padding:0 16px;background:var(--bg-secondary);border-bottom:1px solid var(--border)
}
.header-left{display:flex;align-items:center;gap:12px;min-width:0}
.book-info h1{font-size:16px;font-weight:600;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.book-info span{font-size:12px;color:var(--text-secondary)}
.header-right{display:flex;gap:8px}
.icon-btn{inline-size:44px;block-size:44px;border:none;border-radius:10px;background:transparent;color:var(--text-secondary);display:grid;place-items:center;cursor:pointer;transition:var(--transition)}
.icon-btn:hover{background:var(--bg-tertiary);color:var(--text-primary)}
.icon-btn:focus-visible{outline:3px solid var(--accent);outline-offset:2px}

/* Layout */
.reader-container{flex:1;display:flex;min-height:0}
.reader-sidebar{
  width:320px;max-width:90vw;transform:translateX(-100%);
  background:var(--bg-secondary);border-right:1px solid var(--border);
  transition:transform .25s ease;display:flex;flex-direction:column
}
.reader-sidebar.active{transform:translateX(0)}
.sidebar-tabs{display:flex;border-bottom:1px solid var(--border)}
.sidebar-tab{flex:1;padding:10px 12px;border:none;background:transparent;cursor:pointer;color:var(--text-secondary);border-bottom:3px solid transparent}
.sidebar-tab.active{color:var(--accent);border-bottom-color:var(--accent);background:var(--bg-primary)}
.sidebar-content{flex:1;min-height:0;overflow:auto;padding:12px}
.tab-panel{display:none}
.tab-panel.active{display:block}
.search-box{position:relative;margin-bottom:12px}
.search-box input{
  width:100%;padding:10px 36px 10px 12px;border:1px solid var(--border);border-radius:10px;background:var(--bg-primary);color:var(--text-primary)
}
.search-box i{position:absolute;right:12px;top:50%;transform:translateY(-50%);color:var(--text-muted)}

.toc-list{display:flex;flex-direction:column;gap:6px}
.toc-item{}
.toc-link{display:block;padding:10px;border-radius:8px;text-decoration:none;color:var(--text-primary);background:transparent;border:1px solid transparent}
.toc-link:hover{background:var(--bg-tertiary)}
.toc-link.active{background:var(--accent);color:#fff;border-color:transparent}

.reader-main{flex:1;display:flex;min-width:0;position:relative}
.reader-content{
  flex:1;overflow:auto;padding:clamp(12px,2vw,20px);
  scroll-behavior:smooth;background:var(--bg-primary)
}
.reader-content[data-mode="paginated"]{scroll-snap-type:y mandatory}
.chapter-content>*{scroll-snap-align:start}

/* Typography */
.chapter-content{
  max-width:68ch;margin-inline:auto;
  font-family:var(--font-reading);
  font-size:var(--font-size-reading);
  line-height:var(--line-height-reading);
  hyphens:auto;-webkit-hyphens:auto;word-break:normal
}
.chapter-content h1{font-size:1.9rem;line-height:1.25;margin:0 0 1rem 0}
.chapter-content h2{font-size:1.35rem;margin:2rem 0 1rem}
.chapter-content h3{font-size:1.15rem;margin:1.5rem 0 .75rem}
.chapter-content p{margin:0 0 1rem 0;text-align:justify}
.chapter-content blockquote{margin:1.5rem 0;padding:1rem 1.25rem;border-left:4px solid var(--accent);background:var(--bg-secondary)}
.chapter-content .highlight{background:rgba(255,235,59,.45);padding:2px 3px;border-radius:3px}

/* Overlay */
.reader-overlay{position:absolute;inset:0;background:rgba(0,0,0,.5);opacity:0;pointer-events:none;transition:opacity .25s ease}
.reader-overlay.active{opacity:1;pointer-events:auto}

/* Footer */
.reader-footer{
  height:64px;display:flex;align-items:center;justify-content:space-between;
  padding:0 12px;background:var(--bg-secondary);border-top:1px solid var(--border)
}
.reading-progress{display:flex;align-items:center;gap:10px;min-width:0}
.progress-info{white-space:nowrap;color:var(--text-secondary);font-size:13px}
.progress-bar-container{flex:1;min-width:140px}
.progress-bar{position:relative;height:8px;background:var(--bg-tertiary);border-radius:999px;cursor:pointer}
.progress-fill{height:100%;background:var(--accent);border-radius:999px;width:8%}
.progress-thumb{position:absolute;top:50%;transform:translateY(-50%);width:16px;height:16px;border-radius:50%;background:var(--accent);border:2px solid var(--bg-primary);left:8%;opacity:0;transition:opacity .2s ease}
.progress-bar:hover .progress-thumb{opacity:1}

.footer-center{display:flex;align-items:center;gap:10px}
.nav-btn{inline-size:44px;block-size:44px;border:1px solid var(--border);border-radius:10px;background:var(--bg-primary);color:var(--text-primary);cursor:pointer}
.nav-btn:hover{background:var(--accent);color:#fff;border-color:var(--accent)}
.page-input-container input{
  width:72px;padding:8px;border:1px solid var(--border);border-radius:10px;background:var(--bg-primary);color:var(--text-primary);text-align:center
}

.footer-right{min-width:120px;text-align:right;color:var(--text-secondary);font-size:12px}

/* Modals */
.modal{position:fixed;inset:0;background:rgba(0,0,0,.5);display:flex;align-items:center;justify-content:center;opacity:0;pointer-events:none;transition:opacity .25s ease;z-index:1000}
.modal.active{opacity:1;pointer-events:auto}
.modal-content{background:var(--bg-primary);color:var(--text-primary);border:1px solid var(--border);border-radius:14px;box-shadow:0 20px 60px var(--shadow-lg);width:min(640px,92vw);max-height:88vh;display:flex;flex-direction:column}
.modal-header{display:flex;align-items:center;justify-content:space-between;padding:14px 16px;border-bottom:1px solid var(--border)}
.modal-body{padding:14px 16px;overflow:auto}
.modal-close{inline-size:36px;block-size:36px;border:none;border-radius:10px;background:transparent;color:var(--text-secondary);cursor:pointer}
.modal-close:hover{background:var(--bg-tertiary)}

.settings-group{margin:14px 0}
.settings-group label{display:block;margin-bottom:6px;font-weight:600}
.settings-group select,.settings-group input[type="range"]{width:100%}

.search-modal-content{width:min(720px,94vw)}

.search-input-container{position:relative;margin-bottom:12px}
.search-input-container input{
  width:100%;padding:10px 44px 10px 12px;border:1px solid var(--border);border-radius:10px;background:var(--bg-primary);color:var(--text-primary)
}
.search-input-container button{
  position:absolute;right:6px;top:50%;transform:translateY(-50%);
  inline-size:36px;block-size:36px;border:none;border-radius:10px;background:var(--accent);color:#fff;cursor:pointer
}
.search-options{display:flex;gap:16px;margin-bottom:12px;color:var(--text-secondary)}
.search-results{max-height:320px;overflow:auto;display:flex;flex-direction:column;gap:8px}
.search-result{padding:10px;border:1px solid var(--border);border-radius:10px;background:var(--bg-primary);cursor:pointer}
.search-result:hover{background:var(--bg-tertiary)}
.search-result-chapter{font-size:12px;color:var(--text-secondary);margin-bottom:4px}
.search-result-text{font-size:14px;line-height:1.5}
.search-highlight{background:rgba(255,235,59,.55);padding:0 2px;border-radius:3px}

/* Context menu */
.context-menu{position:fixed;min-width:200px;background:var(--bg-primary);border:1px solid var(--border);border-radius:12px;box-shadow:0 16px 48px var(--shadow-lg);opacity:0;pointer-events:none;transform:scale(.96);transition:opacity .2s ease,transform .2s ease;z-index:1001}
.context-menu.active{opacity:1;pointer-events:auto;transform:scale(1)}
.context-menu button{width:100%;text-align:left;padding:10px 12px;border:none;background:transparent;color:var(--text-primary);cursor:pointer}
.context-menu button:hover{background:var(--bg-tertiary)}

/* Toasts */
.toast-container{position:fixed;inset-block-start:16px;inset-inline-end:16px;display:flex;flex-direction:column;gap:8px;z-index:1100}
.toast{min-width:280px;max-width:420px;padding:12px 14px;background:var(--bg-primary);color:var(--text-primary);border:1px solid var(--border);border-radius:12px;box-shadow:0 12px 36px var(--shadow-lg);transform:translateX(30px);opacity:0;transition:opacity .2s ease,transform .2s ease}
.toast.show{transform:none;opacity:1}
.toast-success{border-left:4px solid #10b981}
.toast-error{border-left:4px solid #ef4444}
.toast-info{border-left:4px solid var(--accent)}

/* Responsive */
@media (max-width: 900px){
  .reader-sidebar{position:absolute;inset-block:64px 64px;z-index:999}
  .chapter-content{max-width:unset}
}
