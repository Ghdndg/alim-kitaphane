/* Premium Reader UI â€” look & feel of top-tier apps */
:root{
  --bg:#0b0b0c; --bg-2:#121215; --bg-3:#1a1b1f;
  --card:#111215; --border:#26272c;
  --text:#eaecef; --muted:#9aa3af;
  --accent:#7c5cff; --accent-2:#5d3fff;
  --ok:#20c997; --warn:#f59f00; --err:#ff6b6b;

  --ui:'Inter',system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
  --serif:'Crimson Text', Georgia, serif;

  --fs:18px; --lh:1.7; --mw:68ch;

  --e: cubic-bezier(.22,.61,.36,1);
  --shadow: 0 10px 30px rgba(0,0,0,.35);
}

@media (prefers-color-scheme: light){
  :root{ --bg:#ffffff; --bg-2:#f6f7f9; --bg-3:#edf0f5; --card:#ffffff; --border:#e7e9ee; --text:#101114; }
}
[data-theme="light"]{ color-scheme:light; }
[data-theme="dark"]{ color-scheme:dark; --bg:#0b0b0c; --bg-2:#121215; --bg-3:#1a1b1f; --card:#111215; --border:#26272c; --text:#eaecef; }
[data-theme="sepia"]{ --bg:#f4efe6; --bg-2:#efe9de; --bg-3:#e7dfd2; --card:#fffaf1; --border:#e2d7c6; --text:#45382b; --accent:#8b6b3d; --accent-2:#6b4f2f; }
[data-theme="auto"]{}

/* Base */
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;background:var(--bg);color:var(--text);
  font-family:var(--ui);-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;
}

/* Loading */
.loading{position:fixed;inset:0;display:grid;place-items:center;background:var(--bg);z-index:9999}
.loading.hidden{opacity:0;pointer-events:none;transition:.3s var(--e)}
.loading__box{padding:24px 28px;background:var(--card);border:1px solid var(--border);border-radius:16px;box-shadow:var(--shadow);text-align:center}
.loading__spinner{width:40px;height:40px;border-radius:50%;border:4px solid var(--border);border-top:4px solid var(--accent);margin:0 auto 10px;animation:spin 1s linear infinite}
.loading__title{font-weight:700;margin-bottom:6px}
.loading__hint{color:var(--muted);font-size:13px}
@keyframes spin{to{transform:rotate(360deg)}}

/* Topbar */
.topbar{
  position:fixed;inset-block-start:0;inset-inline:0;height:56px;display:flex;align-items:center;gap:12px;
  padding:0 10px;background:linear-gradient(to bottom, rgba(0,0,0,.35), transparent);
  -webkit-backdrop-filter:saturate(1.5) blur(10px);backdrop-filter:saturate(1.5) blur(10px);
  z-index:50; opacity:0; transform:translateY(-8px); transition:.25s var(--e)
}
.topbar.show{opacity:1;transform:none}
.topbar .muted{color:var(--muted);font-size:12px}
.topbar__title{min-width:0}
.topbar__title #book-title{font-weight:700;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.topbar__actions{margin-inline-start:auto;display:flex;gap:6px}
.btn{border:1px solid var(--border);background:var(--card);color:var(--text);border-radius:12px;padding:8px 12px;cursor:pointer;transition:.2s var(--e)}
.btn:hover{border-color:var(--accent)}
.btn.icon{inline-size:40px;block-size:40px;display:grid;place-items:center;padding:0}
.btn.pill{border-radius:999px}

/* Sidebar */
.sidebar{
  position:fixed;inset:56px 0 0 auto;width:min(360px,92vw);background:var(--card);border-inline-start:1px solid var(--border);transform:translateX(100%);
  transition:transform .25s var(--e);z-index:60;display:flex;flex-direction:column;
}
.sidebar.show{transform:none}
.sidebar__tabs{display:flex;border-bottom:1px solid var(--border)}
.tab{flex:1;padding:10px 12px;background:transparent;border:none;color:var(--muted);cursor:pointer;border-bottom:3px solid transparent}
.tab.active{color:var(--accent);border-bottom-color:var(--accent)}
.sidebar__body{padding:12px;overflow:auto}
.field{position:relative;margin-bottom:10px}
.field i{position:absolute;left:10px;top:50%;transform:translateY(-50%);color:var(--muted)}
.field input{width:100%;padding:10px 12px 10px 34px;border:1px solid var(--border);border-radius:12px;background:var(--bg-2);color:var(--text)}
.toc{display:flex;flex-direction:column;gap:6px}
.toc a{display:block;padding:10px;border-radius:10px;border:1px solid var(--border);text-decoration:none;color:var(--text);background:var(--card)}
.toc a:hover{border-color:var(--accent)}
.toc .meta{font-size:12px;color:var(--muted);margin-top:4px}

/* Surface (pages) */
.surface{position:fixed;inset:0;display:grid;grid-template-rows:1fr;z-index:10}
.pager{
  position:relative;inset:0;overflow:hidden;
  display:grid;grid-auto-flow:column;grid-auto-columns:100%;
  scroll-snap-type:x mandatory;scroll-behavior:smooth;
}
.page{
  scroll-snap-align:start; padding:clamp(16px,2vw,24px);
  display:flex;align-items:center;justify-content:center;
}
.sheet{
  max-width:var(--mw); width:100%;
  font-family:var(--serif); font-size:var(--fs); line-height:var(--lh);
  color:var(--text); background:var(--bg-2); border:1px solid var(--border); border-radius:16px;
  padding:clamp(16px,3vw,28px); box-shadow:var(--shadow);
}
.sheet h1{font-size:1.9rem;line-height:1.25;margin:0 0 .75rem}
.sheet h2{font-size:1.35rem;margin:1.5rem 0 .75rem}
.sheet p{margin:0 0 1rem;text-align:justify;hyphens:auto;-webkit-hyphens:auto}

/* Tap zones */
.tap-zones{position:absolute;inset:0;display:grid;grid-template-columns:1fr 1fr 1fr;z-index:20}
.zone{appearance:none;background:transparent;border:none}
.zone--left,.zone--right{cursor:pointer}
.zone--center{cursor:pointer}

/* Floating */
.floats{position:fixed;inset-inline:0;inset-block-end:16px;display:grid;place-items:center;z-index:30;pointer-events:none}
.floats__nav{display:flex;gap:8px;align-items:center;background:var(--card);border:1px solid var(--border);border-radius:999px;padding:6px 10px;box-shadow:var(--shadow);pointer-events:auto}
.page-input{width:68px;text-align:center;border:1px solid var(--border);border-radius:10px;background:var(--bg-2);color:var(--text);padding:6px}
.floats__progress{position:fixed;inset-inline:16px;inset-block-end:64px;width:calc(100% - 32px);max-width:680px;margin-inline:auto;background:var(--card);border:1px solid var(--border);border-radius:14px;padding:8px 10px;box-shadow:var(--shadow);pointer-events:auto}
#progress-text{font-size:12px;color:var(--muted);margin-bottom:4px}
.progress{height:6px;background:var(--bg-3);border-radius:999px;overflow:hidden}
.progress__fill{height:100%;width:8%;background:linear-gradient(90deg,var(--accent),var(--accent-2))}

/* Overlays & Modals */
.overlay{position:fixed;inset:0;background:rgba(0,0,0,.35);opacity:0;pointer-events:none;transition:.2s var(--e);z-index:40}
.overlay.show{opacity:1;pointer-events:auto}
.modal{border:0;padding:0;background:transparent}
.modal::backdrop{background:rgba(0,0,0,.4)}
.modal__box{min-width:min(680px,96vw);max-height:80vh;overflow:auto;background:var(--card);border:1px solid var(--border);border-radius:16px;box-shadow:var(--shadow)}
.modal__header,.modal__footer{display:flex;align-items:center;justify-content:space-between;padding:12px 14px;border-bottom:1px solid var(--border)}
.modal__footer{border-top:1px solid var(--border);border-bottom:0}
.modal__body{padding:14px}
.grid{display:grid;gap:12px}
.segmented{display:flex;gap:6px;flex-wrap:wrap}
.seg{border:1px solid var(--border);padding:8px 10px;border-radius:999px;background:var(--bg-2);cursor:pointer}
.seg.active{border-color:var(--accent);color:var(--accent)}

.results{display:flex;flex-direction:column;gap:8px;margin-top:8px}
.results .item{border:1px solid var(--border);border-radius:12px;padding:10px;background:var(--card);cursor:pointer}
.item .cap{font-size:12px;color:var(--muted);margin-bottom:4px}

/* Utils */
.muted{color:var(--muted)}
@media(max-width:900px){ .sheet{max-width:unset} }
